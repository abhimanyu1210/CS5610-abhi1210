<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Music API</title>
        <script type="text/javascript" src="../../../javascript/jquery/jquery-2.1.3.js"></script>
        <script type="text/javascript" src="../../../javascript/jquery-ui-1.11.2.custom/jquery-ui.js"></script>
        <script type="text/javascript" src="musicAPI.js"></script>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
        <link rel="stylesheet" href="week3-api.css" />
    </head>
    <body>
        <header>
            <h1 style="text-align:center;"> Songs And Music API</h1>
        </header>

        <h3>Description:</h3>
        <p>
            This is an experiment for searching songs and music albums over web-based APIs. On entering the name of the song or
            the artist, we get back the results and display the attributes in the table.
        </p>

        <p>
            For this experiment the API I am calling is : <br />
            <a href="http://ws.audioscrobbler.com/2.0/?method=track.search&track=metallica&api_key=644ef0c3c270e9b916642aa04c580b7c&format=json">http://ws.audioscrobbler.com/2.0/?method=track.search&track=metallica&api_key=644ef0c3c270e9b916642aa04c580b7c&format=json</a>
            <br /><br />
            The key for this API was generated by creating an account. The key is:644ef0c3c270e9b916642aa04c580b7c.
        </p>
        <hr />

        <h3>Experiment:</h3>
        <div>
            <label for="songInp">Enter Song Or Artist Name:</label>
            <input type="text" placeholder="Enter Song Or Artist Name Here" id="songInp" />
            <button id="songBtn" class="button" onclick="getSongs();"> Search Songs And Music </button>
            <p>Some examples you can try: (Band:Maroon 5, Metallica) or (Artist: Adam Levine, Miley Cyrus)</p>
        </div>
        <hr />
        <div id="resultsTab">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Album Cover</th>
                        <th>Song</th>
                        <th>Artist</th>
                        <th>Link To Song</th>
                    </tr>
                </thead>
                <tbody id="tbody">
                </tbody>
            </table>
        </div>

        <hr />

        <div id="codeSnipp">
            <p>Here is a part of the jQuery that creates the table and parses the JSON object returned on Success.</p>
            <pre>
                    success: function (songs) {
                            var length = songs['results']['trackmatches']['track'].length;
                
                            var tbody = $("#tbody");
                            tbody.empty();
                            for (var i = 0; i < length; i++) {
                                var tr = $("&lt;tr&gt;");
                    
                                // get album cover
                                if ((typeof (songs['results']['trackmatches']['track'][i]['image']) != "undefined")) {
                                    var cover_length = songs['results']['trackmatches']['track'][i]['image'].length;
                                    var cover = songs['results']['trackmatches']['track'][i]['image'][cover_length - 1]['#text'];
                                } else {
                                    cover = "../../../images/homepage/backIcon.jpg";
                                }
                                var image = $("&lt;img&gt;").attr("src", cover);
                                $("&lt;td&gt;").append(image).appendTo(tr);
                                // get song name
                                var song = songs['results']['trackmatches']['track'][i]['name'];
                                $("&lt;td&gt;").append(song).appendTo(tr);
                                // get artist name
                                var artist = songs['results']['trackmatches']['track'][i]['artist'];
                                $("&lt;td&gt;").append(artist).appendTo(tr);
                                // get link to song
                                var linkToSong = songs['results']['trackmatches']['track'][i]['url'];
                    
                                $("&lt;td&gt;").append($('&lt;a&gt;', {text: 'Listen',href: linkToSong})).appendTo(tr);
                                tr.appendTo(tbody);
                            }
                        }
                    });
            </pre>
        </div>


        <hr />
        <div id="footerId">
            <hr />
            <section style="clear:both">
                <h3> Source Code</h3>
                <a href="../../../fileview/Default.aspx?~/experiments/API/003-musicAPI.html" target="_blank">HTML</a>
                <a href="../../../fileview/Default.aspx?~/experiments/API/musicAPI.js" target="_blank">Javascript</a>
                <a href="../../../fileview/Default.aspx?~/experiments/API/week3-api.css" target="_blank">CSS</a>
            </section>
        </div>
    </body>
</html>
